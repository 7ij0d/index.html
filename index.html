<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Generator Pro</title>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
/* كل الأنماط كما هي */
:root {
    --primary: #c40000;
    --primary-dark: #9d0000;
    --bg: #0b0b0b;
    --card-bg: #151515;
    --text: #ffffff;
    --text-secondary: #aaaaaa;
    --border: #333333;
    --success: #00a86b;
    --warning: #ff9800;
}

* {
    box-sizing: border-box;
}

body {
    background: var(--bg);
    margin: 0;
    padding: 20px;
    color: var(--text);
    font-family: 'Segoe UI', Arial, sans-serif;
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
}

/* Header */
.header {
    background: linear-gradient(135deg, #1a1a1a, #0d0d0d);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.header h1 {
    margin: 0;
    color: var(--primary);
    font-size: 32px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.header p {
    color: var(--text-secondary);
    margin: 10px 0 0 0;
}

/* Stats Cards */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
}

.stat-card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 15px;
    text-align: center;
    transition: transform 0.3s, box-shadow 0.3s;
}

.stat-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(0,0,0,0.4);
}

.stat-number {
    font-size: 24px;
    font-weight: bold;
    color: var(--primary);
}

.stat-label {
    font-size: 14px;
    color: var(--text-secondary);
    margin-top: 5px;
}

/* Input Styles */
input, textarea, select {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    background: #1a1a1a;
    color: var(--text);
    border: 1px solid var(--border);
    border-radius: 8px;
    font-size: 16px;
    transition: border 0.3s;
}

input:focus, textarea:focus, select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(196, 0, 0, 0.2);
}

textarea {
    min-height: 120px;
    resize: vertical;
    font-family: 'Courier New', monospace;
    line-height: 1.5;
}

/* Button Styles */
.btn {
    padding: 12px 20px;
    margin: 8px 5px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    gap: 8px;
}

.btn-primary {
    background: var(--primary);
    color: white;
}

.btn-primary:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.btn-secondary {
    background: #2a2a2a;
    color: white;
}

.btn-secondary:hover {
    background: #3a3a3a;
}

.btn-success {
    background: var(--success);
    color: white;
}

.btn-warning {
    background: var(--warning);
    color: white;
}

.btn-group {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin: 20px 0;
}

/* Question Cards */
.question-card {
    background: var(--card-bg);
    border: 2px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin: 15px 0;
    position: relative;
    transition: all 0.3s;
}

.question-card:hover {
    border-color: var(--primary);
}

.question-card.selected {
    border-color: var(--primary);
    background: rgba(196, 0, 0, 0.05);
}

.question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
}

.question-number {
    font-size: 18px;
    font-weight: bold;
    color: var(--primary);
}

.question-actions {
    display: flex;
    gap: 8px;
}

.action-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--text-secondary);
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}

.action-btn:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Output Preview */
.output-container {
    background: var(--card-bg);
    border: 2px solid var(--border);
    border-radius: 12px;
    padding: 25px;
    margin-top: 30px;
    position: relative;
}

.output-actions {
    position: absolute;
    top: 15px;
    right: 15px;
    display: flex;
    gap: 10px;
}

.preview-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--primary);
}

/* Toast Notifications */
.toast {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--success);
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    display: none;
    z-index: 1000;
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 1001;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 30px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}

/* Progress Bar */
.progress-container {
    margin: 20px 0;
}

.progress-bar {
    height: 8px;
    background: #2a2a2a;
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary);
    width: 0%;
    transition: width 0.3s;
}

/* Responsive */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    .btn-group {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 10px;
}

::-webkit-scrollbar-track {
    background: #1a1a1a;
}

::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
}

/* Quick Actions */
.quick-actions {
    background: var(--card-bg);
    border-radius: 10px;
    padding: 15px;
    margin: 20px 0;
}

.quick-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 10px;
    margin-top: 10px;
}

/* Format Hint */
.format-hint {
    background: #1a1a1a;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px;
    margin: 10px 0;
    font-size: 13px;
    color: var(--text-secondary);
}

.format-hint strong {
    color: var(--primary);
}

.format-hint code {
    background: #2a2a2a;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: monospace;
    margin: 0 2px;
}

/* New Question Entry Style */
.question-entry {
    margin: 20px 0;
}

.question-textarea {
    min-height: 200px;
    font-family: 'Courier New', monospace;
    line-height: 1.6;
    background: #1a1a1a;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 15px;
    color: white;
    width: 100%;
    resize: vertical;
}

.format-examples {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin: 10px 0;
}

.format-example {
    background: #2a2a2a;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #444;
    font-family: monospace;
    font-size: 13px;
}
</style>
</head>

<body>
<div class="container">
    <!-- Home Screen -->
    <div id="homeScreen">
        <div class="header">
            <h1><i class="fas fa-graduation-cap"></i> Quiz Generator Pro</h1>
            <p>Create, manage, and export professional quizzes with ease</p>
        </div>
        
        <div class="stats-container" id="homeStats">
            <!-- Stats will be populated by JavaScript -->
        </div>
        
        <div class="btn-group">
            <button class="btn btn-primary" onclick="newQuiz()">
                <i class="fas fa-plus"></i> New Quiz
            </button>
            <button class="btn btn-secondary" onclick="showLoadMenu()">
                <i class="fas fa-folder-open"></i> Load Quiz
            </button>
            <button class="btn btn-secondary" onclick="showTemplates()">
                <i class="fas fa-layer-group"></i> Templates
            </button>
            <button class="btn btn-secondary" onclick="showStats()">
                <i class="fas fa-chart-bar"></i> Statistics
            </button>
        </div>
        
        <div id="loadMenu" style="display:none; margin-top:20px;">
            <h3><i class="fas fa-search"></i> Select Quiz</h3>
            <div class="input-group">
                <input type="text" id="searchQuiz" placeholder="Search quizzes..." onkeyup="filterQuizzes()">
            </div>
            <div style="display:flex; gap:15px; margin:15px 0;">
                <select id="loadSubject" style="flex:1;"></select>
                <select id="loadSheet" style="flex:1;"></select>
            </div>
            <div id="quizList" style="max-height:300px; overflow-y:auto; margin:15px 0;"></div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="loadSelectedQuiz()">
                    <i class="fas fa-external-link-alt"></i> Open Selected
                </button>
                <button class="btn btn-warning" onclick="deleteSelectedQuiz()">
                    <i class="fas fa-trash"></i> Delete Selected
                </button>
                <button class="btn btn-secondary" onclick="exportSelectedQuiz()">
                    <i class="fas fa-download"></i> Export as JSON
                </button>
            </div>
        </div>
        
        <div id="recentQuizzes" style="margin-top:30px; display:none;">
            <h3><i class="fas fa-history"></i> Recent Quizzes</h3>
            <div id="recentList"></div>
        </div>
    </div>
    
    <!-- Main Editor -->
    <div id="mainUI" style="display:none;">
        <!-- Header -->
        <div class="header">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h2><i class="fas fa-edit"></i> Quiz Editor</h2>
                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="goHome()">
                        <i class="fas fa-home"></i> Home
                    </button>
                    <button class="btn btn-secondary" onclick="autoSave()" id="saveStatus">
                        <i class="fas fa-save"></i> Save
                    </button>
                </div>
            </div>
            
            <div class="progress-container">
                <div>Quiz Completion: <span id="completionPercent">0%</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="completionBar"></div>
                </div>
            </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions">
            <h4><i class="fas fa-bolt"></i> Quick Actions</h4>
            <div class="quick-buttons">
                <button class="btn btn-secondary" onclick="duplicateLastQuestion()">
                    <i class="fas fa-copy"></i> Duplicate Last
                </button>
                <button class="btn btn-secondary" onclick="clearAllQuestions()">
                    <i class="fas fa-broom"></i> Clear All
                </button>
                <button class="btn btn-secondary" onclick="randomizeAnswers()">
                    <i class="fas fa-random"></i> Randomize
                </button>
                <button class="btn btn-secondary" onclick="validateQuiz()">
                    <i class="fas fa-check-circle"></i> Validate
                </button>
            </div>
        </div>
        
        <!-- Quiz Metadata -->
        <div class="metadata-grid" style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; margin:20px 0;">
            <div>
                <label><i class="fas fa-heading"></i> Sheet Name:</label>
                <input id="sheetName" placeholder="Enter quiz name">
            </div>
            <div>
                <label><i class="fas fa-book"></i> Subject:</label>
                <select id="subjectSelect" onchange="toggleOtherSubject()">
                    <option value="">Select Subject</option>
                    <option>Oral histology</option>
                    <option>Microbiology</option>
                    <option>Removeable prosthodontic</option>
                    <option>Pathology</option>
                    <option>Fixed prosthodontic</option>
                    <option>Conservative</option>
                    <option>Pharmacology</option>
                    <option value="other">Other</option>
                </select>
                <input id="otherSubject" placeholder="Write subject name" style="display:none; margin-top:5px;">
            </div>
            <div>
                <label><i class="fas fa-users"></i> Group:</label>
                <select id="groupSelect" onchange="toggleOtherGroup()">
                    <option value="">Select Group</option>
                    <option>A1-B1</option>
                    <option>C1-D1</option>
                    <option>A2-B2</option>
                    <option>C2-D2</option>
                    <option value="other">Other</option>
                </select>
                <input id="otherGroup" placeholder="Write group name" style="display:none; margin-top:5px;">
            </div>
            <div>
                <label><i class="fas fa-calendar"></i> Date:</label>
                <div style="display:flex; gap:5px;">
                    <select id="year" style="flex:1;">
                        <option>2025</option>
                        <option selected>2026</option>
                        <option>2027</option>
                        <option>2028</option>
                    </select>
                    <select id="month" style="flex:1;">
                        <option value="01">Jan</option><option value="02">Feb</option>
                        <option value="03">Mar</option><option value="04">Apr</option>
                        <option value="05">May</option><option value="06">Jun</option>
                        <option value="07">Jul</option><option value="08">Aug</option>
                        <option value="09">Sep</option><option value="10">Oct</option>
                        <option value="11">Nov</option><option value="12">Dec</option>
                    </select>
                    <select id="day" style="flex:1;"></select>
                </div>
            </div>
        </div>
        
        <!-- Format Hint -->
        <div class="format-hint">
            <strong>Format Hint:</strong> You can write questions in any format. Examples:
            <div class="format-examples">
                <div class="format-example">A) Option text<br>A- Option text<br>A. Option text<br>A Option text</div>
                <div class="format-example">B) Option text<br>B- Option text<br>B. Option text<br>B Option text</div>
                <div class="format-example">C) Option text<br>C- Option text<br>C. Option text<br>C Option text</div>
                <div class="format-example">D) Option text<br>D- Option text<br>D. Option text<br>D Option text</div>
                <div class="format-example">a) Option text<br>a- Option text<br>a. Option text<br>a Option text</div>
            </div>
            Just select the correct answer from the dropdown menu below each question.
        </div>
        
        <!-- Question Generator -->
        <div style="background:var(--card-bg); padding:20px; border-radius:10px; margin:20px 0;">
            <h3><i class="fas fa-question-circle"></i> Questions</h3>
            
            <div style="display:flex; gap:15px; align-items:center; margin:15px 0;">
                <div style="flex:1;">
                    <label>Number of Questions:</label>
                    <select id="questionCount" onchange="createQuestions()" style="width:100%;">
                        <option value="">-- Select Number --</option>
                        <option value="1">1 Question</option>
                        <option value="5">5 Questions</option>
                        <option value="10">10 Questions</option>
                        <option value="15">15 Questions</option>
                        <option value="20">20 Questions</option>
                        <option value="25">25 Questions</option>
                        <option value="30">30 Questions</option>
                        <option value="40">40 Questions</option>
                        <option value="50">50 Questions</option>
                    </select>
                </div>
                <div style="display:flex; gap:10px; margin-top:20px;">
                    <button class="btn btn-primary" onclick="addSingleQuestion()">
                        <i class="fas fa-plus"></i> Add One
                    </button>
                    <button class="btn btn-secondary" onclick="importQuestions()">
                        <i class="fas fa-file-import"></i> Import
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Questions Container -->
        <div id="questionsContainer"></div>
        
        <!-- Action Buttons -->
        <div class="btn-group" style="justify-content:center; margin:30px 0;">
            <button class="btn btn-primary" onclick="previewQuiz()">
                <i class="fas fa-eye"></i> Preview
            </button>
            <button class="btn btn-success" onclick="saveQuiz()">
                <i class="fas fa-save"></i> Save Quiz
            </button>
            <button class="btn btn-warning" onclick="generate()">
                <i class="fas fa-file-export"></i> Generate Output
            </button>
            <button class="btn btn-secondary" onclick="printQuiz()">
                <i class="fas fa-print"></i> Print
            </button>
        </div>
        
        <!-- Output Preview -->
        <div id="output" style="display:none;">
            <div class="output-container">
                <div class="output-actions">
                    <button class="action-btn" onclick="copyOutput()" title="Copy HTML">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="action-btn" onclick="downloadOutput()" title="Download as HTML">
                        <i class="fas fa-download"></i>
                    </button>
                </div>
                <div id="outputContent"></div>
            </div>
            
            <div class="btn-group" style="justify-content:center; margin:20px 0;">
                <button class="btn btn-primary" onclick="saveImage()">
                    <i class="fas fa-image"></i> Save as Image
                </button>
                <button class="btn btn-secondary" onclick="savePDF()">
                    <i class="fas fa-file-pdf"></i> Save as PDF
                </button>
                <button class="btn btn-secondary" onclick="shareQuiz()">
                    <i class="fas fa-share-alt"></i> Share
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>
    
    <!-- Templates Modal -->
    <div id="templatesModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-layer-group"></i> Quiz Templates</h3>
            <div id="templatesList"></div>
            <div class="btn-group" style="margin-top:20px;">
                <button class="btn btn-secondary" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>
    
    <!-- Import Modal -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-file-import"></i> Import Questions</h3>
            <textarea id="importText" placeholder="Paste questions here in format:
1. Question text
A) Option A
B) Option B
C) Option C
D) Option D
E) Option E
Correct: A" style="height:300px;"></textarea>
            <div class="btn-group" style="margin-top:20px;">
                <button class="btn btn-primary" onclick="parseImportedQuestions()">Import</button>
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>
</div>

<script>
// Initialize
let currentQuiz = null;
let autoSaveTimer = null;
let recentQuizzes = JSON.parse(localStorage.getItem('recentQuizzes') || '[]');

// Toast notification
function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.style.background = type === 'error' ? 'var(--primary)' : 'var(--success)';
    toast.style.display = 'block';
    
    setTimeout(() => {
        toast.style.display = 'none';
    }, 3000);
}

// Populate days
for(let i = 1; i <= 31; i++) {
    let d = i < 10 ? "0" + i : i;
    day.innerHTML += `<option>${d}</option>`;
}

// Initialize home stats
function updateHomeStats() {
    const statsContainer = document.getElementById('homeStats');
    const allQuizzes = Object.keys(localStorage).filter(k => k.startsWith('quiz_'));
    
    let totalQuestions = 0;
    allQuizzes.forEach(key => {
        const quiz = JSON.parse(localStorage.getItem(key));
        totalQuestions += quiz.questions.length;
    });
    
    statsContainer.innerHTML = `
        <div class="stat-card">
            <div class="stat-number">${allQuizzes.length}</div>
            <div class="stat-label">Total Quizzes</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">${totalQuestions}</div>
            <div class="stat-label">Total Questions</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">${recentQuizzes.length}</div>
            <div class="stat-label">Recently Viewed</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">${new Set(allQuizzes.map(k => k.split('_')[1])).size}</div>
            <div class="stat-label">Subjects</div>
        </div>
    `;
}

// Toggle other fields
function toggleOtherSubject() {
    otherSubject.style.display = subjectSelect.value === "other" ? "block" : "none";
}

function toggleOtherGroup() {
    otherGroup.style.display = groupSelect.value === "other" ? "block" : "none";
}

// Navigation
function newQuiz() {
    homeScreen.style.display = "none";
    mainUI.style.display = "block";
    updateCompletion();
}

function goHome() {
    homeScreen.style.display = "block";
    mainUI.style.display = "none";
    updateHomeStats();
}

// Auto-save functionality
function startAutoSave() {
    if (autoSaveTimer) clearInterval(autoSaveTimer);
    autoSaveTimer = setInterval(autoSave, 30000); // Auto-save every 30 seconds
}

function autoSave() {
    if (!sheetName.value) return;
    saveQuiz(true);
}

// Update completion percentage
function updateCompletion() {
    const totalFields = 5; // sheet name, subject, group, date, at least 1 question
    let completed = 0;
    
    if (sheetName.value) completed++;
    if (subjectSelect.value) completed++;
    if (groupSelect.value) completed++;
    if (year.value && month.value && day.value) completed++;
    if (document.querySelectorAll('.question-card').length > 0) completed++;
    
    const percent = Math.round((completed / totalFields) * 100);
    document.getElementById('completionPercent').textContent = percent + '%';
    document.getElementById('completionBar').style.width = percent + '%';
}

// Create questions
function createQuestions() {
    let count = parseInt(questionCount.value);
    if (!count || count < 1) return;
    
    questionsContainer.innerHTML = "";
    
    for (let i = 1; i <= count; i++) {
        createQuestionElement(i);
    }
    
    updateCompletion();
    startAutoSave();
}

function createQuestionElement(number) {
    let div = document.createElement("div");
    div.className = "question-card";
    div.dataset.number = number;
    
    div.innerHTML = `
        <div class="question-header">
            <div class="question-number">Question ${number}</div>
            <div class="question-actions">
                <button class="action-btn" onclick="moveQuestionUp(this)" title="Move Up">
                    <i class="fas fa-arrow-up"></i>
                </button>
                <button class="action-btn" onclick="moveQuestionDown(this)" title="Move Down">
                    <i class="fas fa-arrow-down"></i>
                </button>
                <button class="action-btn" onclick="duplicateQuestion(this)" title="Duplicate">
                    <i class="fas fa-copy"></i>
                </button>
                <button class="action-btn" onclick="deleteQuestion(this)" title="Delete">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        
        <div class="question-entry">
            <textarea class="qText question-textarea" placeholder="Enter your question and options here...
Example format:
What is the capital of France?
A) Paris
B) London
C) Berlin
D) Madrid

Or any format:
What is 2+2?
A- 3
B- 4
C- 5
D- 6"></textarea>
        </div>
        
        <div style="margin-top:15px;">
            <label>Correct Answer:</label>
            <select class="correctAnswer" style="width:100%;">
                <option value="">Select Correct Answer</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
                <option value="E">E</option>
            </select>
        </div>
        
        <div style="margin-top:15px; padding-top:15px; border-top:1px solid var(--border);">
            <label>Explanation (optional):</label>
            <textarea class="explanation" placeholder="Add explanation for the correct answer..." 
                      style="height:60px; margin-top:5px; width:100%;"></textarea>
        </div>
    `;
    
    questionsContainer.appendChild(div);
}

function addSingleQuestion() {
    const count = document.querySelectorAll('.question-card').length;
    createQuestionElement(count + 1);
    questionCount.value = count + 1;
    updateCompletion();
}

// Question manipulation
function moveQuestionUp(btn) {
    const card = btn.closest('.question-card');
    const prev = card.previousElementSibling;
    if (prev) {
        card.parentNode.insertBefore(card, prev);
        renumberQuestions();
    }
}

function moveQuestionDown(btn) {
    const card = btn.closest('.question-card');
    const next = card.nextElementSibling;
    if (next) {
        card.parentNode.insertBefore(next, card);
        renumberQuestions();
    }
}

function duplicateQuestion(btn) {
    const card = btn.closest('.question-card');
    const newCard = card.cloneNode(true);
    newCard.dataset.number = parseInt(card.dataset.number) + 1;
    card.parentNode.insertBefore(newCard, card.nextSibling);
    renumberQuestions();
}

function duplicateLastQuestion() {
    const cards = document.querySelectorAll('.question-card');
    if (cards.length === 0) return;
    duplicateQuestion(cards[cards.length - 1].querySelector('.action-btn'));
}

function deleteQuestion(btn) {
    if (confirm('Delete this question?')) {
        const card = btn.closest('.question-card');
        card.remove();
        renumberQuestions();
        updateCompletion();
    }
}

function clearAllQuestions() {
    if (confirm('Clear all questions?')) {
        questionsContainer.innerHTML = "";
        questionCount.value = "";
        updateCompletion();
    }
}

function renumberQuestions() {
    document.querySelectorAll('.question-card').forEach((card, index) => {
        card.dataset.number = index + 1;
        card.querySelector('.question-number').textContent = `Question ${index + 1}`;
    });
}

// Validate quiz
function validateQuiz() {
    let errors = [];
    
    if (!sheetName.value) errors.push('Sheet name is required');
    if (!subjectSelect.value) errors.push('Subject is required');
    
    document.querySelectorAll('.question-card').forEach((card, index) => {
        const questionText = card.querySelector('.qText').value.trim();
        const correctAnswer = card.querySelector('.correctAnswer').value;
        
        if (!questionText) errors.push(`Question ${index + 1} has no text`);
        if (!correctAnswer) errors.push(`Question ${index + 1} has no correct answer selected`);
    });
    
    if (errors.length === 0) {
        showToast('Quiz is valid! Ready to save.');
    } else {
        alert('Validation Errors:\n\n' + errors.join('\n'));
    }
}

// Save quiz
function saveQuiz(silent = false) {
    if (!sheetName.value) {
        if (!silent) showToast('Please enter a sheet name!', 'error');
        return;
    }
    
    let subject = subjectSelect.value === "other" ? otherSubject.value : subjectSelect.value;
    let group = groupSelect.value === "other" ? otherGroup.value : groupSelect.value;
    
    let key = "quiz_" + subject + "_" + sheetName.value;
    
    let data = {
        sheetName: sheetName.value,
        subject: subject,
        group: group,
        year: year.value,
        month: month.value,
        day: day.value,
        createdAt: new Date().toISOString(),
        modifiedAt: new Date().toISOString(),
        questions: []
    };
    
    document.querySelectorAll(".question-card").forEach(card => {
        const questionText = card.querySelector('.qText').value;
        const correctAnswer = card.querySelector('.correctAnswer').value;
        const explanation = card.querySelector('.explanation').value;
        
        data.questions.push({
            text: questionText,
            answer: correctAnswer,
            explanation: explanation
        });
    });
    
    localStorage.setItem(key, JSON.stringify(data));
    
    // Add to recent quizzes
    const recentIndex = recentQuizzes.findIndex(q => q.key === key);
    if (recentIndex !== -1) {
        recentQuizzes.splice(recentIndex, 1);
    }
    recentQuizzes.unshift({
        key: key,
        name: sheetName.value,
        subject: subject,
        date: new Date().toLocaleDateString()
    });
    
    if (recentQuizzes.length > 10) {
        recentQuizzes = recentQuizzes.slice(0, 10);
    }
    
    localStorage.setItem('recentQuizzes', JSON.stringify(recentQuizzes));
    
    if (!silent) {
        showToast('Quiz saved successfully!');
        document.getElementById('saveStatus').innerHTML = '<i class="fas fa-check"></i> Saved';
        setTimeout(() => {
            document.getElementById('saveStatus').innerHTML = '<i class="fas fa-save"></i> Save';
        }, 2000);
    }
    
    updateHomeStats();
}

// Load quiz system
const subjects = [
    "Oral histology", "Microbiology", "Removeable prosthodontic",
    "Pathology", "Fixed prosthodontic", "Conservative", "Pharmacology"
];

function showLoadMenu() {
    loadMenu.style.display = "block";
    populateSubjectSelect();
    updateQuizList();
    
    const recentList = document.getElementById('recentList');
    if (recentQuizzes.length > 0) {
        recentList.innerHTML = recentQuizzes.map(quiz => `
            <div style="padding:10px; border:1px solid var(--border); margin:5px 0; border-radius:6px; cursor:pointer;" 
                 onclick="loadQuizByKey('${quiz.key}')">
                <strong>${quiz.name}</strong> - ${quiz.subject}<br>
                <small>${quiz.date}</small>
            </div>
        `).join('');
        document.getElementById('recentQuizzes').style.display = 'block';
    }
}

function populateSubjectSelect() {
    loadSubject.innerHTML = '<option value="">All Subjects</option>';
    subjects.forEach(s => {
        let opt = document.createElement("option");
        opt.textContent = s;
        loadSubject.appendChild(opt);
    });
}

function updateQuizList() {
    const searchTerm = document.getElementById('searchQuiz')?.value.toLowerCase() || '';
    const subjectFilter = loadSubject.value;
    
    const allKeys = Object.keys(localStorage).filter(k => k.startsWith('quiz_'));
    const quizList = document.getElementById('quizList');
    
    quizList.innerHTML = '';
    
    allKeys.forEach(k => {
        try {
            const data = JSON.parse(localStorage.getItem(k));
            
            // Apply filters
            if (subjectFilter && !k.includes(subjectFilter)) return;
            if (searchTerm && !data.sheetName.toLowerCase().includes(searchTerm)) return;
            
            const div = document.createElement('div');
            div.className = 'quiz-list-item';
            div.style.cssText = `
                padding:12px; border:1px solid var(--border); 
                margin:8px 0; border-radius:8px; cursor:pointer;
                background: var(--card-bg); transition: all 0.3s;
            `;
            div.onmouseover = () => div.style.borderColor = 'var(--primary)';
            div.onmouseout = () => div.style.borderColor = 'var(--border)';
            div.onclick = () => {
                document.querySelectorAll('.quiz-list-item').forEach(i => {
                    i.style.background = 'var(--card-bg)';
                });
                div.style.background = 'rgba(196, 0, 0, 0.1)';
                loadSheet.value = data.sheetName;
            };
            
            div.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:start;">
                    <div>
                        <strong style="color:var(--primary);">${data.sheetName}</strong><br>
                        <small>${data.subject} • ${data.group}</small><br>
                        <small>${data.questions.length} questions • ${data.modifiedAt ? new Date(data.modifiedAt).toLocaleDateString() : ''}</small>
                    </div>
                    <div style="text-align:right;">
                        <small style="color:var(--text-secondary);">${data.year}-${data.month}-${data.day}</small>
                    </div>
                </div>
            `;
            
            quizList.appendChild(div);
        } catch(e) {
            console.error('Error loading quiz:', e);
        }
    });
}

function filterQuizzes() {
    updateQuizList();
}

function loadSelectedQuiz() {
    const subject = loadSubject.value || '';
    const name = loadSheet.value;
    
    if (!name) {
        showToast('Please select a quiz!', 'error');
        return;
    }
    
    const key = subject ? `quiz_${subject}_${name}` : 
        Object.keys(localStorage).find(k => k.endsWith(`_${name}`));
    
    if (key) {
        loadQuizByKey(key);
    } else {
        showToast('Quiz not found!', 'error');
    }
}

function loadQuizByKey(key) {
    const raw = localStorage.getItem(key);
    if (!raw) return;
    
    const data = JSON.parse(raw);
    currentQuiz = { key, data };
    
    // Switch to editor
    newQuiz();
    
    // Populate fields
    sheetName.value = data.sheetName;
    subjectSelect.value = data.subject;
    groupSelect.value = data.group;
    year.value = data.year;
    month.value = data.month;
    day.value = data.day;
    
    // Clear and create questions
    questionsContainer.innerHTML = "";
    questionCount.value = data.questions.length;
    
    data.questions.forEach((q, index) => {
        createQuestionElement(index + 1);
        const card = document.querySelectorAll('.question-card')[index];
        
        // Set question text
        card.querySelector('.qText').value = q.text;
        
        // Set correct answer
        if (q.answer) {
            card.querySelector('.correctAnswer').value = q.answer;
        }
        
        // Set explanation
        if (q.explanation) {
            card.querySelector('.explanation').value = q.explanation;
        }
    });
    
    showToast('Quiz loaded successfully!');
    updateCompletion();
}

function deleteSelectedQuiz() {
    const name = loadSheet.value;
    if (!name) return;
    
    if (confirm(`Delete quiz "${name}"?`)) {
        const subject = loadSubject.value || '';
        const key = subject ? `quiz_${subject}_${name}` : 
            Object.keys(localStorage).find(k => k.endsWith(`_${name}`));
        
        if (key) {
            localStorage.removeItem(key);
            updateQuizList();
            showToast('Quiz deleted!');
        }
    }
}

function exportSelectedQuiz() {
    const name = loadSheet.value;
    if (!name) return;
    
    const subject = loadSubject.value || '';
    const key = subject ? `quiz_${subject}_${name}` : 
        Object.keys(localStorage).find(k => k.endsWith(`_${name}`));
    
    if (key) {
        const data = localStorage.getItem(key);
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${name}.json`;
        a.click();
        URL.revokeObjectURL(url);
        showToast('Quiz exported!');
    }
}

// Generate output - FIXED VERSION
function generate() {
    if (!document.querySelectorAll('.question-card').length) {
        showToast('Please add questions first!', 'error');
        return;
    }
    
    let subject = subjectSelect.value === "other" ? otherSubject.value : subjectSelect.value;
    let group = groupSelect.value === "other" ? otherGroup.value : groupSelect.value;
    
    let html = `
        <div class="preview-header">
            <div style="font-size:32px; font-weight:bold; color:var(--primary);">${subject}</div>
            ${sheetName.value ? `<div style="display:inline-block; margin-top:10px; padding:6px 15px; font-size:16px; color:#ff3b3b; background:#1a1a1a; border:2px solid #ff3b3b; border-radius:8px; font-weight:600;">${sheetName.value}</div>` : ""}
            <div style="display:flex; justify-content:center; gap:15px; margin-top:15px; flex-wrap:wrap;">
                <div style="background:#101010; border:1px solid #2d2d2d; border-radius:8px; padding:8px 16px;">
                    Group: ${group}
                </div>
                <div style="background:#101010; border:1px solid #2d2d2d; border-radius:8px; padding:8px 16px;">
                    Date: ${year.value}-${month.value}-${day.value}
                </div>
            </div>
        </div>
    `;
    
    document.querySelectorAll(".question-card").forEach((card, index) => {
        const questionText = card.querySelector('.qText').value;
        const correctAnswer = card.querySelector('.correctAnswer').value;
        const explanation = card.querySelector('.explanation').value;
        
        html += `<div style="margin-bottom:30px; padding-bottom:20px; border-bottom:2px solid #2a2a2a;">`;
        html += `<div style="font-weight:bold; color:var(--primary); margin-bottom:10px;">Question ${index + 1}</div>`;
        
        // Split question text into lines
        const lines = questionText.split('\n');
        let hasOptions = false;
        
        lines.forEach(l => {
            l = l.trim();
            if (!l) return;
            
            // Check if this line could be an option
            // Supports multiple formats: A), A., A-, A (with space), and lowercase versions
            const optionRegex = /^([A-Ea-e])[\.\)\-\:\s]/;
            const match = l.match(optionRegex);
            
            if (match && correctAnswer) {
                hasOptions = true;
                const optionLetter = match[1].toUpperCase();
                
                if (optionLetter === correctAnswer) {
                    // This is the correct answer - highlight it in red
                    html += `<div style="color:#ff0000; font-weight:bold; margin:5px 0; padding:5px; background:rgba(255,0,0,0.1); border-radius:4px; border-left:3px solid #ff0000;">${l}</div>`;
                } else {
                    html += `<div style="color:#cfcfcf; margin:5px 0;">${l}</div>`;
                }
            } else {
                // Regular text (question or other content)
                html += `<div style="color:#cfcfcf; margin:5px 0;">${l}</div>`;
            }
        });
        
        // If no options were found with the regex, show a warning
        if (!hasOptions && lines.length > 1) {
            html += `<div style="color:#ff9800; margin:10px 0; padding:10px; background:rgba(255,152,0,0.1); border-radius:4px; border-left:3px solid #ff9800;">
                <i class="fas fa-exclamation-triangle"></i> No formatted options detected. Make sure options start with A), B), C), D), or E) (or A., B-, etc.)
            </div>`;
        }
        
        // Add explanation if exists
        if (explanation) {
            html += `<div style="margin-top:10px; padding:10px; background:rgba(0,168,107,0.1); border-left:4px solid var(--success); border-radius:4px;">
                <strong>Explanation:</strong> ${explanation}
            </div>`;
        }
        
        html += `</div>`;
    });
    
    html += `<div style="margin-top:40px; text-align:right; font-size:14px; color:#666; border-top:1px solid #333; padding-top:10px;">
        Generated by Quiz Generator Pro • @Idkwjwnn
    </div>`;
    
    document.getElementById('outputContent').innerHTML = html;
    document.getElementById('output').style.display = 'block';
    showToast('Output generated successfully! Correct answers are highlighted in red.');
    
    // Scroll to output
    document.getElementById('output').scrollIntoView({ behavior: 'smooth' });
}

// Preview function
function previewQuiz() {
    generate();
}

// Copy output
function copyOutput() {
    const content = document.getElementById('outputContent').innerHTML;
    navigator.clipboard.writeText(content).then(() => {
        showToast('HTML copied to clipboard!');
    });
}

// Download output
function downloadOutput() {
    const content = document.getElementById('outputContent').innerHTML;
    const fullHtml = `
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body { background:#0b0b0b; color:white; font-family:Arial; padding:40px; max-width:800px; margin:0 auto; }
                .question { margin-bottom:30px; padding-bottom:20px; border-bottom:2px solid #2a2a2a; }
                .answer { color:#ff0000; font-weight:bold; background:rgba(255,0,0,0.1); padding:5px; border-left:3px solid #ff0000; border-radius:4px; }
            </style>
        </head>
        <body>
            ${content}
        </body>
        </html>
    `;
    
    const blob = new Blob([fullHtml], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${sheetName.value || 'quiz'}.html`;
    a.click();
    URL.revokeObjectURL(url);
    showToast('HTML file downloaded!');
}

// ===== Save as Image - الإصدار المصحح تمامًا =====
async function saveImage() {
    if (!document.getElementById('outputContent').innerHTML) {
        showToast('Please generate the quiz first!', 'error');
        return;
    }
    
    try {
        const saveBtn = document.querySelector('button[onclick="saveImage()"]');
        const originalText = saveBtn.innerHTML;
        saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
        saveBtn.disabled = true;
        
        // أبعاد ثابتة بنسبة 4:3 (مثل شاشة iPad)
        const CONTAINER_WIDTH = 1200;   // عرض ثابت
        const CONTAINER_HEIGHT = 900;   // ارتفاع ثابت (نسبة 4:3)
        
        // إنشاء حاوية خارجية ثابتة الأبعاد
        const container = document.createElement('div');
        container.style.position = 'fixed';
        container.style.left = '-9999px';
        container.style.top = '0';
        container.style.width = CONTAINER_WIDTH + 'px';
        container.style.height = CONTAINER_HEIGHT + 'px';
        container.style.background = '#0b0b0b';
        container.style.overflow = 'hidden';
        container.style.display = 'flex';
        container.style.alignItems = 'flex-start';
        container.style.justifyContent = 'center';
        
        // إنشاء عنصر داخلي للمحتوى
        const contentDiv = document.createElement('div');
        contentDiv.style.width = '100%';
        contentDiv.style.maxWidth = '1000px'; // عرض المحتوى الداخلي أقل من العرض الكلي
        contentDiv.style.background = '#0b0b0b';
        contentDiv.style.color = 'white';
        contentDiv.style.fontFamily = 'Arial, sans-serif';
        contentDiv.style.padding = '40px 20px';
        contentDiv.style.boxSizing = 'border-box';
        
        // نسخ محتوى outputContent
        contentDiv.innerHTML = document.getElementById('outputContent').innerHTML;
        
        // إضافة المحتوى إلى الحاوية
        container.appendChild(contentDiv);
        document.body.appendChild(container);
        
        // الانتظار لضمان تحميل وتصيير المحتوى
        await new Promise(resolve => setTimeout(resolve, 500));
        
        // حساب ارتفاع المحتوى الفعلي
        const contentRealHeight = contentDiv.scrollHeight;
        console.log('ارتفاع المحتوى الفعلي:', contentRealHeight, 'px');
        
        // حساب معامل التصغير المطلوب
        let scale = 1;
        if (contentRealHeight > CONTAINER_HEIGHT) {
            scale = CONTAINER_HEIGHT / contentRealHeight;
        }
        console.log('معامل التصغير:', scale);
        
        // تطبيق التصغير على المحتوى
        contentDiv.style.transform = `scale(${scale})`;
        contentDiv.style.transformOrigin = 'top center';
        contentDiv.style.width = (1000 / scale) + 'px'; // تعديل العرض قبل التصغير ليصبح 1000 بعد التصغير
        contentDiv.style.height = (contentRealHeight * scale) + 'px';
        contentDiv.style.margin = '0 auto';
        
        // إعادة حساب حجم الحاوية بعد التصغير
        container.style.height = Math.min(CONTAINER_HEIGHT, contentRealHeight * scale) + 'px';
        
        // الانتظار للتأكد من تطبيق التحويلات
        await new Promise(resolve => setTimeout(resolve, 300));
        
        // إنشاء الصورة
        const canvas = await html2canvas(container, {
            backgroundColor: '#0b0b0b',
            scale: 2, // دقة عالية
            useCORS: true,
            logging: false,
            width: CONTAINER_WIDTH,
            height: CONTAINER_HEIGHT
        });
        
        // تنظيف العناصر المؤقتة
        document.body.removeChild(container);
        
        // حفظ الصورة
        const link = document.createElement('a');
        const fileName = `${sheetName.value || 'quiz'}_${subjectSelect.value || 'subject'}.png`;
        link.download = fileName;
        link.href = canvas.toDataURL('image/png');
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showToast('Image saved successfully!');
        
    } catch (error) {
        console.error('Error saving image:', error);
        showToast('Error saving image!', 'error');
    } finally {
        const saveBtn = document.querySelector('button[onclick="saveImage()"]');
        saveBtn.innerHTML = '<i class="fas fa-image"></i> Save as Image';
        saveBtn.disabled = false;
    }
}

// ===== Save as PDF =====
async function savePDF() {
    if (!document.getElementById('outputContent').innerHTML) {
        showToast('Please generate the quiz first!', 'error');
        return;
    }
    
    try {
        const saveBtn = document.querySelector('button[onclick="savePDF()"]');
        const originalText = saveBtn.innerHTML;
        saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating PDF...';
        saveBtn.disabled = true;
        
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4'
        });
        
        const content = document.getElementById('outputContent').innerHTML;
        
        // إنشاء عنصر مؤقت لتصدير المحتوى كصورة
        const tempDiv = document.createElement('div');
        tempDiv.style.width = '210mm';  // عرض A4 بالمليمتر
        tempDiv.style.background = '#ffffff';
        tempDiv.style.color = '#000000';
        tempDiv.style.fontFamily = 'Arial, sans-serif';
        tempDiv.style.padding = '20mm';
        tempDiv.style.boxSizing = 'border-box';
        tempDiv.innerHTML = content;
        document.body.appendChild(tempDiv);
        
        await new Promise(resolve => setTimeout(resolve, 300));
        
        const canvas = await html2canvas(tempDiv, {
            scale: 2,
            useCORS: true,
            logging: false,
            backgroundColor: '#ffffff'
        });
        
        document.body.removeChild(tempDiv);
        
        const imgData = canvas.toDataURL('image/jpeg', 0.9);
        const pageWidth = pdf.internal.pageSize.getWidth();
        const pageHeight = pdf.internal.pageSize.getHeight();
        
        // حساب أبعاد الصورة لتناسب الصفحة
        const imgWidth = pageWidth - 20; // هوامش
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        
        // إضافة الصورة إلى PDF
        pdf.addImage(imgData, 'JPEG', 10, 10, imgWidth, imgHeight);
        
        pdf.save(`${sheetName.value || 'quiz'}.pdf`);
        showToast('PDF saved successfully!');
        
    } catch (error) {
        console.error('Error creating PDF:', error);
        showToast('Error creating PDF!', 'error');
    } finally {
        const saveBtn = document.querySelector('button[onclick="savePDF()"]');
        saveBtn.innerHTML = '<i class="fas fa-file-pdf"></i> Save as PDF';
        saveBtn.disabled = false;
    }
}

// ===== Share function =====
function shareQuiz() {
    if (!document.getElementById('outputContent').innerHTML) {
        showToast('Please generate the quiz first!', 'error');
        return;
    }
    
    const quizData = {
        title: sheetName.value || 'Quiz',
        subject: subjectSelect.value === "other" ? otherSubject.value : subjectSelect.value,
        group: groupSelect.value === "other" ? otherGroup.value : groupSelect.value,
        date: `${year.value}-${month.value}-${day.value}`
    };
    
    const shareText = `${quizData.title}\nSubject: ${quizData.subject}\nGroup: ${quizData.group}\nDate: ${quizData.date}\n\nGenerated by Quiz Generator Pro`;
    
    navigator.clipboard.writeText(shareText).then(() => {
        showToast('Quiz details copied to clipboard!');
    }).catch(() => {
        const textArea = document.createElement('textarea');
        textArea.value = shareText;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showToast('Quiz details copied to clipboard!');
    });
}

// ===== دالة الطباعة =====
function printQuiz() {
    if (!document.getElementById('outputContent').innerHTML) {
        showToast('Please generate the quiz first!', 'error');
        return;
    }
    
    const printContent = document.getElementById('outputContent').innerHTML;
    const originalContent = document.body.innerHTML;
    
    document.body.innerHTML = `
        <!DOCTYPE html>
        <html>
        <head>
            <title>${sheetName.value || 'Quiz'} - Print</title>
            <style>
                @media print {
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    .page-break { page-break-after: always; }
                    .no-print { display: none !important; }
                }
                body { max-width: 800px; margin: 0 auto; }
                .question { margin-bottom: 25px; }
                .correct-answer { color: #c40000; font-weight: bold; }
            </style>
        </head>
        <body>
            ${printContent}
            <script>
                window.onload = function() {
                    window.print();
                    setTimeout(function() {
                        document.body.innerHTML = \`${originalContent.replace(/`/g, '\\`')}\`;
                        window.location.reload();
                    }, 500);
                };
            <\/script>
        </body>
        </html>
    `;
}

// Initialize on load
window.addEventListener('load', () => {
    updateHomeStats();
    
    // Add input listeners for auto-save
    document.querySelectorAll('input, select, textarea').forEach(input => {
        input.addEventListener('input', updateCompletion);
        input.addEventListener('change', updateCompletion);
    });
    
    // Auto-save on beforeunload
    window.addEventListener('beforeunload', () => {
        if (sheetName.value) autoSave();
    });
});

// Close modals on ESC
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal').forEach(m => {
            m.style.display = 'none';
        });
    }
});
</script>
</body>
    </html>
